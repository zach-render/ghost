services:
- type: web
  name: ghost
  env: docker
  autoDeploy: false
  disk:
    name: ghost
    mountPath: /var/lib/ghost/content
    sizeGB: 10 #Feel free to change this to suit your needs.
  envVars:
    - fromGroup: mysql
    - fromGroup: ghost

- type: pserv
  name: mysql
  plan: standard
  env: docker
  repo: https://github.com/render-examples/mysql
  autoDeploy: false
  disk:
    name: mysql
    mountPath: /var/lib/mysql
    sizeGB: 10
  envVars:
    - fromGroup: mysql

envVarGroups:
  - name: ghost
    envVars:
      - database__client:
        value: mysql
      - database__connection__host:
        fromSevice:
          type: pserv
          name: mysql
          property: host
      - database__connection__database:
        value: mysql
      - database__connection__user:
        value: mysql
      - database__connection__password:
        sync: false
  - name: mysql
    envVars:
      - key: MYSQL_DATABASE
        value: mysql
      - key: MYSQL_USER
        value: mysql
      - key: MYSQL_PASSWORD
        generateValue: true
      - key: MYSQL_ROOT_PASSWORD
        generateValue: true
